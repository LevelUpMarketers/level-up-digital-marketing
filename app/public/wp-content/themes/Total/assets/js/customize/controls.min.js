!function(t,e){"use strict";const o=wp.customize;e.hasOwnProperty("headerBuilderNotice")&&o.panel("wpex_header",(function(t){t.expanded.bind((function o(n){if(n){const n=document.querySelector("#sub-accordion-panel-wpex_header .panel-meta");n&&((t,e)=>{const o=document.createElement("li");o.innerHTML=`<div class="totaltheme-customize-notice" style="margin:12px;">${e}</div>`,t.prepend(o),t.closest("ul").insertBefore(o,t.nextElementSibling)})(n,e.headerBuilderNotice),t.expanded.unbind(o)}}))}));let n="",a="";document.addEventListener("DOMContentLoaded",(()=>{if("object"==typeof e.themeColors){let t=document.querySelector("#totaltheme-color-palette-light-inline-css");t&&(n=t.sheet.cssRules[0]);let e=document.querySelector("#totaltheme-color-palette-dark-inline-css");e&&(a=e.sheet.cssRules[0])}}));const i=o=>{if(void 0===t.fn.chosen)return;const n=o.find("select");if(!n)return;const a=o.find(".total-customize-chosen-wrap");a&&a.addClass(`total-customize-chosen-wrap--${e.adminColor}`);n.find("option").length<35||n.chosen({width:"100%",search_contains:!0,disable_search_threshold:5})};_.each(["totaltheme_card_select","totaltheme_font_family","wpex-dropdown-pages"],(function(t){o.controlConstructor[t]=o.Control.extend({ready:function(){i(this.container)}})}));o.controlConstructor.totaltheme_color=o.Control.extend({ready:function(){const t=this,o=t.container.get(0),i=o.querySelector(".totaltheme-component-color__hidden-input");i&&("function"==typeof window.totalthemeRenderComponentColor&&window.totalthemeRenderComponentColor(o),i.addEventListener("change",(()=>{t.setting.set(i.value)})),t.params.hasOwnProperty("color_slug")&&((t,o)=>{const i=(t,e,o)=>{t.style.setProperty(e,o)},s=(t,e)=>{t.style.removeProperty(e)},l=l=>{let c=t.value,r=Object.entries(e.themeColors),u="dark"===l?a:n;c.startsWith("palette-")?c=`var(--wpex-${c}-color)`:r.hasOwnProperty(c)&&(c=`var(--wpex-${c})`);for(const[t,e]of r)if(o===e.slug){c&&c!==e.color?(i(u,`--wpex-${o}`,c),"accent"!==o&&"on-accent"!==o||i(u,`--wpex-${o}-alt`,c)):(s(u,`--wpex-${o}`),"accent"!==o&&"on-accent"!==o||s(u,`--wpex-${o}-alt`));break}};t.addEventListener("totaltheme-component-color:close",(()=>{l("light"),l("dark")}))})(i,t.params.color_slug))}}),o.controlConstructor.totaltheme_template_select=o.Control.extend({ready:function(){const o=this,n=o.container,a=n.find("select"),s=n.find(".totaltheme-customize-create-template"),l=s.find(".totaltheme-customize-create-template__form"),c=s.find(".totaltheme-customize-create-template__name"),r=s.find(".totaltheme-customize-create-template__add-item"),u=s.find(".totaltheme-customize-create-template__save"),m=s.find(".totaltheme-customize-create-template__spinner"),d=s.find(".totaltheme-customize-create-template__cancel"),h=l.data("wpex-template-type");i(n);a.on("change",(t=>{a.val()?s.css("display","none"):s.css("display","")})),r.on("click",(t=>{t.preventDefault(),r.css("display","none"),l.addClass("totaltheme-customize-create-template__form--visible")})),c.on("input",(t=>{c.removeClass("totaltheme-customize-create-template__name--invalid")})),d.on("click",(t=>{t.preventDefault(),r.css("display",""),l.removeClass("totaltheme-customize-create-template__form--visible")})),u.on("click",(a=>{a.preventDefault();const i=c.val();if(i){const a=new XMLHttpRequest,s="action=totaltheme_customize_create_template&nonce="+e.nonce+"&post_title="+i+"&type="+h,c="Something wen't wrong, please try again or create your template via the WP dashboard.";a.onload=function(){if(m.removeClass("totaltheme-customize-create-template__spinner--visible"),d.css("display",""),4==a.readyState&&200==a.status){let e=this.responseText;if(!e)return void alert(c);e=JSON.parse(this.responseText),e.success&&e.template_id&&(l.parent().remove(),l.removeClass("totaltheme-customize-create-template__form--visible"),n.find("select").append(t(`<option selected="selected" value="${e.template_id}">${i}</option>`)),o.setting.set(e.template_id))}else alert(c),console.log(this.responseText)},a.open("POST",window.ajaxurl,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.send(s),m.addClass("totaltheme-customize-create-template__spinner--visible"),d.css("display","none")}else c.addClass("totaltheme-customize-create-template__name--invalid"),c.focus()}))}}),o.controlConstructor.totaltheme_multi_select=o.Control.extend({ready:function(){const e=this;e.container.on("change",".totaltheme-customize-multi-select__input",(function(o){o.preventDefault();let n="";e.container.find(".totaltheme-customize-multi-select__input").each((function(){t(this).is(":checked")&&(n+=t(this).attr("value")+",")})),e.setting.set(n.replace(/,+$/,""))}))}}),o.controlConstructor.wpex_social_profiles=o.Control.extend({ready:function(){var o=this,n=o.container,a=n.find(".totaltheme-customize-social-profiles__list");a.sortable(),a.on("sortstop",(function(t,e){o.updateValue()})),t(document).on("input",'.totaltheme-customize-social-profiles__item input[type="text"]',(function(){o.updateValue()})),n.on("click",".totaltheme-customize-social-profiles__delete-item",(function(n){confirm(e.deleteConfirm)&&(t(this).parents(".totaltheme-customize-social-profiles__item").remove(),o.updateValue()),n.preventDefault()})),n.find(".totaltheme-customize-social-profiles__add-item").click((function(t){t.preventDefault();var a=n.find(".totaltheme-customize-social-profiles__select").find(":selected");if(a){var i=a.val();if(n.find('input[data-wpex-key="'+i+'"]').length)return void alert(e.duplicate);var s=n.find(".totaltheme-customize-social-profiles__template").clone();s.removeClass("totaltheme-customize-social-profiles__template"),s.addClass("totaltheme-customize-social-profiles__item"),s.find("label span").text(a.text()),s.find("input").val("#").attr("data-wpex-key",i),s.appendTo(n.find(".totaltheme-customize-social-profiles__list")),o.updateValue(),n.find(".totaltheme-customize-social-profiles__list").sortable("refresh")}}))},updateValue:function(){var e=this,o={},n=0;e.container.find('.totaltheme-customize-social-profiles__item input[type="text"]').each((function(e,a){var i=t(this),s=i.val();s&&(n++,o[i.attr("data-wpex-key")]=s)})),0==n?e.setting.set(""):e.setting.set(JSON.stringify(o))}}),o.controlConstructor.wpex_textarea=o.Control.extend({ready:function(){var e=this.container,o=function(t){var e={"&amp;":"&","&#038;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'","&#8217;":"’","&#8216;":"‘","&#8211;":"–","&#8212;":"—","&#8230;":"…","&#8221;":"”"};return t.replace(/\&[\w\d\#]{2,5}\;/g,(function(t){return e[t]}))};e.find(".totaltheme-customize-textarea-toolbar button").on("click",(function(n){var a=t(this).data("wpex-insert");if(a){var i=e.find(".totaltheme-customize-textarea"),s=i.val();s?i.val(s+"\n"+o(a)):i.val(o(a)),i.trigger("change")}n.preventDefault()}))}}),o.controlConstructor.totaltheme_icon=o.Control.extend({ready:function(){const t=this;t.container.get(0).querySelector(".totaltheme-icon-select__input").addEventListener("change",(e=>{t.setting.set(e.target.value)}))}}),o.controlConstructor.totaltheme_toggle=o.Control.extend({ready:function(){this.container.find('input[type="checkbox"]').change((function(){t(this).closest(".totaltheme-customize-toggle-control").toggleClass("totaltheme-customize-toggle-control--checked",this.checked)}))}}),o.controlConstructor["wpex-columns"]=o.Control.extend({ready:function(){var e=this;e.container.find(".totaltheme-customize-columns__select").change((function(t){e.updateValue()})),e.container.find(".totaltheme-customize-columns__toggle").on("click",(function(){return e.container.find(".totaltheme-customize-columns__extra").toggleClass("totaltheme-customize-columns__hidden"),"false"===t(this).attr("aria-expanded")?(t(this).attr("aria-expanded","true"),e.container.find(".totaltheme-customize-columns__extra:first select").focus()):t(this).attr("aria-expanded","false"),!1}))},updateValue:function(){var e={},o=0;this.container.find(".totaltheme-customize-columns__select").each((function(n,a){var i=t(this),s=i.children("option:selected").val();s&&(o++,e[i.attr("data-name")]=s)})),0===o?e="":1===o&&(e=e.d),this.setting.set(e)}}),o.controlConstructor.totaltheme_trbl=o.Control.extend({ready:function(){const e=this,o=e.container.find(".totaltheme-customize-trbl").attr("data-wpex-shorthand"),n=e.container.find(".totaltheme-customize-trbl__input"),a="px";e.container.on("input",".totaltheme-customize-trbl__input",(function(){let i="",s=null,l=!0,c=!0,r=[],u=[];n.each((function(e,n){let i=t(this),m=i.val();""!==m&&(c=!1),0===e&&(s=m),s!==m&&(l=!1),"true"===o?(m=m||"0px",isNaN(m)||(m+=a),r.push(m)):m&&(isNaN(m)||(m+=a),u.push(i.attr("data-name")+":"+m),r.push(m))})),c?i="":l?(isNaN(s)||(s+=a),i=s):i=4===r.length&&r[0]==r[2]&&r[1]==r[3]?r[0]+" "+r[1]:"true"===o?r.join(" "):u.join("|"),e.setting.set(i)}))}}),o.controlConstructor.totaltheme_length_unit=o.Control.extend({ready:function(){const e=this;e.container.on("input",".totaltheme-customize-length-unit__input",(function(){e.updateValue(t(this))})),e.container.on("focus",".totaltheme-customize-length-unit__input",(function(){e.container.find(".totaltheme-customize-length-unit").addClass("totaltheme-customize-length-unit--focused")})),e.container.on("blur",".totaltheme-customize-length-unit__input",(function(){e.container.find(".totaltheme-customize-length-unit").removeClass("totaltheme-customize-length-unit--focused")})),e.container.on("change",".totaltheme-customize-length-unit__select",(function(){const o=t(this),n=o.find("option:selected").val(),a=e.container.find(".totaltheme-customize-length-unit__input");o.attr("data-unit",n),n!==o.find("option").first().val()?a.attr("placeholder",""):a.attr("placeholder",a.attr("data-placeholder")),"func"===n||"var"===n||"calc"===n||"clamp"===n?(a.attr("type","text"),a.attr("inputmode","text")):(a.attr("type","number"),a.attr("inputmode","numeric")),e.updateValue(a)}))},updateValue:function(t){const e=this;let o=t.val();if(o){let t=e.container.find(".totaltheme-customize-length-unit__select option:selected").val();switch("int"===t&&(t=""),t){case"func":break;case"var":o.includes("var(")||(o="var("+o.trim()+")");break;default:o=parseFloat(o),o=isNaN(o)?"":o+t}}else e.updatePlaceholder();e.setting.set(String(o.trim()))},updatePlaceholder:function(){const t=this,e=t.container.find(".totaltheme-customize-length-unit__input");t.container.find(".totaltheme-customize-length-unit__select option:selected").val()!==t.container.find(".totaltheme-customize-length-unit__select option").first().val()?e.attr("placeholder",""):e.attr("placeholder",e.attr("data-placeholder"))}}),o.controlConstructor.totaltheme_responsive_input=o.Control.extend({ready:function(){const t=this;t.container.find(".totaltheme-customize-responsive-field__input").on("input",(function(e){t.updateValue()}))},updateValue:function(){const e=this;var o={},n=0;e.container.find(".totaltheme-customize-responsive-field__input").each((function(e,a){const i=t(this),s=i.val();s&&(n++,o[i.attr("data-name")]=s)})),0==n?e.setting.set(""):e.setting.set(JSON.stringify(o))}}),o.controlConstructor.totaltheme_font_size=o.Control.extend({ready:function(){const t=this,e=t.container.get(0);let o=null;e.addEventListener("input",(e=>{e.target.closest(".totaltheme-customize-responsive-field__input")&&t.updateValue()})),e.addEventListener("focusin",(t=>{const e=t.target.closest(".totaltheme-customize-responsive-field__input");e&&(o=e)})),e.addEventListener("click",(n=>{const a=n.target.closest(".total-theme-customize-font-size__actions a");o||(o=e.querySelector(".totaltheme-customize-responsive-field__input")),a&&(o.value=a.innerText,t.updateValue())}))},updateValue:function(){const e=this;var o={},n=0;e.container.find(".totaltheme-customize-responsive-field__input").each((function(e,a){const i=t(this),s=i.val();s&&(n++,o[i.attr("data-name")]=s)})),0==n?e.setting.set(""):e.setting.set(JSON.stringify(o))}}),o.controlConstructor.totaltheme_svg_select=o.Control.extend({ready:function(){const e=this;e.container.on("change",".totaltheme-customize-svg-select select",(function(){const o=t(this).find("option:selected").val();e.container.find(".totaltheme-customize-svg-select-icon").each((function(){let e=t(this);o?e.attr("data-wpex-value")==o?e.removeClass("totaltheme-customize-svg-select-icon--hidden"):e.addClass("totaltheme-customize-svg-select-icon--hidden"):e.hasClass("totaltheme-customize-svg-select-icon--default")?e.removeClass("totaltheme-customize-svg-select-icon--hidden"):e.addClass("totaltheme-customize-svg-select-icon--hidden")}))}))}}),o.controlConstructor.totaltheme_blocks=o.Control.extend({ready:function(){const o=this,n=o.container,a=n.find(".totaltheme-customize-blocks__list");a.sortable({placeholder:"totaltheme-customize-blocks__sortable-placeholder"}),a.on("sortstop",(function(t,e){o.updateValue()})),n.on("click",".totaltheme-customize-blocks__delete-item",(function(n){confirm(e.deleteConfirm)&&(t(this).parents(".totaltheme-customize-blocks__item").remove(),o.updateValue()),n.preventDefault()})),n.find(".totaltheme-customize-blocks__add-button").click((function(t){t.preventDefault();const a=n.find(".totaltheme-customize-blocks__select").find(":selected");if(a){const t=a.val();if(!t)return;if(n.find('.totaltheme-customize-blocks__item[data-wpex-key="'+t+'"]').length)return void alert(e.duplicate);const i=n.find(".totaltheme-customize-blocks__template").clone();i.removeClass("totaltheme-customize-blocks__template"),i.addClass("totaltheme-customize-blocks__item").attr("data-wpex-key",t),i.find(".totaltheme-customize-blocks__item-name").text(a.text()),i.appendTo(n.find(".totaltheme-customize-blocks__list")),o.updateValue(),n.find(".totaltheme-customize-blocks__list").sortable("refresh")}}))},updateValue:function(){const e=this;let o="";e.container.find(".totaltheme-customize-blocks__item").each((function(e,n){o+=t(this).attr("data-wpex-key")+","})),o.trim()?(e.container.find(".totaltheme-customize-blocks").addClass("totaltheme-customize-blocks--has-blocks"),e.setting.set(o.replace(/,+$/,""))):(e.container.find(".totaltheme-customize-blocks").removeClass("totaltheme-customize-blocks--has-blocks"),e.setting.set(""))}})}(jQuery,totaltheme_customize_controls_vars);